---
layout: base
---
{% import "macros.njk" as macros %}

<article class="h-entry post post-review">
  <header class="post-header">
    <h1 class="p-name post-title">{{ title }}</h1>

    <div class="post-meta">
      <time class="dt-published" datetime="{{ page.date | isoDate }}">
        {{ page.date | readableDate }}
      </time>
      {% if reviewItem or itemUrl %}
      <div class="post-review-item">
        Reviewing: 
        {% if itemUrl %}
          <span class="p-item h-product">
            {% if reviewItem %}
              <a href="{{ itemUrl }}" class="p-name u-url" target="_blank" rel="noopener">{{ reviewItem }}</a>
            {% else %}
              <a href="{{ itemUrl }}" class="u-url" target="_blank" rel="noopener">{{ itemUrl }}</a>
            {% endif %}
          </span>
        {% elif reviewItem %}
          <span class="p-item">{{ reviewItem }}</span>
        {% endif %}
      </div>
      {% endif %}
      {% if rating %}
      <div class="post-rating">
        <span class="p-rating">
          {{ macros.starRating(rating) }}
        </span>
      </div>
      {% endif %}
    </div>

    {% if tags %}
    <div class="post-tags">
      {% for tag in tags %}
      <a href="{{ ('/tags/' + (tag | slugify) + '/') | url }}" class="p-category">{{ tag }}</a>
      {% endfor %}
    </div>
    {% endif %}
  </header>

  <div class="e-content post-content">
    {{ content | safe }}
  </div>

  {% if discussionUrl %}
  <footer class="post-footer">
    <div class="post-discussion">
      <h3>Comments</h3>
      
      {% set discussionNum = discussionUrl | discussionNumber %}
      {% set discussion = discussionComments[discussionNum] %}
      
      {% if discussion and discussion.comments.length > 0 %}
        <div class="discussion-comments">
          {% for comment in discussion.comments %}
            <div class="discussion-comment" id="comment-{{ comment.id }}">
              <div class="comment-header">
                <img src="{{ comment.author.avatarUrl }}" alt="{{ comment.author.login }}" class="comment-avatar" width="40" height="40">
                <div class="comment-meta">
                  <a href="{{ comment.author.url }}" class="comment-author">{{ comment.author.login }}</a>
                  <time datetime="{{ comment.createdAt }}" class="comment-date">
                    {{ comment.createdAt | readableDateISO }}
                  </time>
                </div>
              </div>
              <div class="comment-body">
                {{ comment.bodyHTML | safe }}
              </div>
              
              {% if comment.replies.length > 0 %}
                <div class="comment-replies">
                  {% for reply in comment.replies %}
                    <div class="discussion-comment comment-reply" id="comment-{{ reply.id }}">
                      <div class="comment-header">
                        <img src="{{ reply.author.avatarUrl }}" alt="{{ reply.author.login }}" class="comment-avatar" width="32" height="32">
                        <div class="comment-meta">
                          <a href="{{ reply.author.url }}" class="comment-author">{{ reply.author.login }}</a>
                          <time datetime="{{ reply.createdAt }}" class="comment-date">
                            {{ reply.createdAt | readableDateISO }}
                          </time>
                        </div>
                      </div>
                      <div class="comment-body">
                        {{ reply.bodyHTML | safe }}
                      </div>
                    </div>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
          {% endfor %}
        </div>
      {% endif %}
      
      <p class="discussion-link">
        <a href="{{ discussionUrl }}">Join the discussion on GitHub â†’</a>
      </p>
    </div>
  </footer>
  {% endif %}

  {# Hidden microformats data #}
  <a class="u-url" href="{{ page.url | url }}" hidden></a>
  <a class="u-uid" href="{{ siteConfig.site.url }}{{ page.url }}" hidden></a>
  <span class="p-author h-card" hidden>
    <a class="p-name u-url" href="{{ siteConfig.site.author.url }}">{{ siteConfig.site.author.name }}</a>
  </span>
</article>

{% if siteConfig.features.webmentions.enabled and siteConfig.features.webmentions.receive %}
<section class="webmentions">
  <h3>Webmentions</h3>
  <div id="webmentions-container">
    <p><em>Loading webmentions...</em></p>
  </div>
</section>
{% endif %}
